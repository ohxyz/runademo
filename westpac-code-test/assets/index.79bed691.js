import{j as d,R as h,a as p,r as m}from"./vendor.32140213.js";const c=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function t(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerpolicy&&(a.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?a.credentials="include":i.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(i){if(i.ep)return;i.ep=!0;const a=t(i);fetch(i.href,a)}};c();const s=d.exports.jsx,l=d.exports.jsxs;function u({patternIndex:r,rankIndex:e,onSnap:t}){const n=["club","diamond","heart","spade"],i=e===11?"J":e===12?"Q":e===13?"K":e===1?"A":e;return l("div",{className:"card",onClick:t,children:[s("div",{className:"rank-top",children:i}),s("div",{className:`pattern ${n[r]}`}),s("div",{className:"rank-bottom",children:i})]})}function f(r){for(let e=r.length-1;e>0;e--){const t=Math.floor(Math.random()*(e+1));[r[e],r[t]]=[r[t],r[e]]}}class g{constructor(){this.middlePile=[],this.playerPile=[],this.computerPile=[],this.areCardsSame=!1,this.isStopped=!1,[this.playerPile,this.computerPile]=this.genCards()}stop(){this.isStopped=!0}genCards(){const e=[];for(let t=0;t<4;t++)for(let n=1;n<=13;n++)e.push([t,n]);return f(e),[e.slice(0,e.length/2),e.slice(e.length/2,e.length)]}moveToMiddle(e){if(this.isStopped)return;if(e.length===0)throw new Error("Pile is empty!");const t=e.pop();this.middlePile.push(t),this.middlePile.length>1&&(this.areCardsSame=this.middlePile[this.middlePile.length-1][1]===this.middlePile[this.middlePile.length-2][1]),this.canSnap()&&console.log("Can snap!",this.middlePile[this.middlePile.length-1],this.middlePile[this.middlePile.length-2])}snap(e){if(this.isStopped)return;const t=this.middlePile.concat(e);return this.middlePile=[],this.areCardsSame=!1,t}playerMove(){this.moveToMiddle(this.playerPile)}computerMove(){this.moveToMiddle(this.computerPile)}playerSnap(){this.playerPile=this.snap(this.playerPile)}computerSnap(){this.computerPile=this.snap(this.computerPile)}canSnap(){return this.areCardsSame}getWinner(){return this.computerPile.length===0?"Player":this.playerPile.length===0?"Computer":""}getInfo(){return{computerLeft:this.computerPile.length,playerLeft:this.playerPile.length,middleNow:this.middlePile.length,cardOnTop:this.middlePile.length?this.middlePile[this.middlePile.length-1]:null}}}class S extends h.Component{constructor(e){super(e);this.timeBeforeFlipCard=2e3,this.reactionTime=2e3,this.computerMoveTimeoutId=0,this.computerSnapTimeoutId=0,this.computerSnapTimeoutId2=0,this.state={table:e.dealer.getInfo(),isComputerMoving:!1,isGameStopped:!1,message:""}}handlePlayerMove(){if(this.state.isGameStopped){alert("Game has stopped!");return}if(this.state.isComputerMoving){alert("Computer is thinking!");return}this.props.dealer.playerMove(),this.setState({table:this.props.dealer.getInfo(),isComputerMoving:!0,message:"Computer's turn"}),this.computerMoveTimeoutId=setTimeout(this.handleComputerMove.bind(this),this.timeBeforeFlipCard)}handleComputerMove(){if(this.state.isGameStopped){alert("Game has stopped!");return}this.computerSnapTimeoutId=setTimeout(()=>{this.handleComputerSnap(),this.props.dealer.computerMove(),this.computerSnapTimeoutId2=setTimeout(()=>{this.handleComputerSnap(),this.setState({table:this.props.dealer.getInfo()})},this.reactionTime),this.setState({table:this.props.dealer.getInfo(),isComputerMoving:!1,message:"Player's turn"})},this.reactionTime)}handleComputerSnap(){this.props.dealer.canSnap()&&!this.state.isGameStopped&&(alert("Computer calls snap!"),this.props.dealer.computerSnap())}handleSnap(){if(this.state.isGameStopped){alert("Game has stopped!");return}if(!this.props.dealer.canSnap()){alert("Cards not same!");return}alert("Player calls snap!"),this.props.dealer.playerSnap(),this.setState({table:this.props.dealer.getInfo()})}handleStartClick(){clearTimeout(this.computerMoveTimeoutId),clearTimeout(this.computerSnapTimeoutId),clearTimeout(this.computerSnapTimeoutId2),this.props.onStartClick()}handleSlide(e){const t=e.target.value;this.reactionTime=parseInt(t)*1e3}componentDidUpdate(){if(this.state.isGameStopped)return;const e=this.props.dealer.getWinner();e&&(alert(e+" wins!"),this.setState({isGameStopped:!0}))}render(){return l("div",{className:"game",children:[s("div",{className:"message",children:this.state.message}),l("div",{className:"row0",children:[l("div",{children:[s("div",{className:"name",children:"Computer"}),s("div",{className:"computer-pile"}),l("div",{className:"number",children:[this.state.table.computerLeft," cards left"]})]}),l("div",{className:"middle-pile",children:[this.state.table.cardOnTop?s(u,{patternIndex:this.state.table.cardOnTop[0],rankIndex:this.state.table.cardOnTop[1],onSnap:this.handleSnap.bind(this)}):s("div",{className:"empty"}),l("div",{className:"number",children:[this.state.table.middleNow," cards now"]})]}),l("div",{children:[s("div",{className:"name",children:"Player"}),s("button",{className:"player-pile",onClick:this.handlePlayerMove.bind(this)}),l("div",{className:"number",children:[this.state.table.playerLeft," cards left"]})]})]}),s("div",{className:"row1",children:s("button",{className:"start-button",onClick:this.handleStartClick.bind(this),children:"Start"})}),l("div",{className:"row2",children:[s("label",{className:"slider-label",htmlFor:"seconds",children:"Reaction time 1 - 10 seconds"}),s("input",{type:"range",id:"seconds",name:"seconds",min:"1",max:"10",defaultValue:"2",onChange:this.handleSlide.bind(this)})]})]})}}function v(){const[r,e]=m.exports.useState(!0);function t(){e(!1),setTimeout(()=>{e(!0)},1e3)}return r?s(S,{dealer:new g,onStartClick:t}):s("em",{children:"Restarting..."})}p.render(s(v,{}),document.getElementById("root"));
